1. Write a query to display all the first_name  in upper case

ans:  Select Upper(first_name) from worker;

2. Write a querty to display unique department from workers table

ans: select distinct(departments) from worker;

3. Write an SQL query to print the first three characters of FIRST_NAME from Worker table

ans: select substring(first_name,1,3)"FirstName" from worker;


4.  Write an SQL query to find the position of the alphabet (‘a’) in the first name column ‘Amitabh’ from Worker table.

ans: select first_name,position("a" in first_name) as "Position of a" from worker;

5.  Write an SQL query that fetches the unique values of DEPARTMENT from Worker table and prints its length

ans:   select distinct(department),length(department)as "Number of characters" from worker;

6.  Write an SQL query to print all Worker details from the Worker table order by FIRST_NAME Ascending and DEPARTMENT Descending

ans:  select * from worker order by first_name,department desc;

7. Write a query to get workers whose name are Vipul and Satish

ans: select first_name from worker where first_name IN("Vipul","Satish");

8.  Write an SQL query to print details of the Workers whose FIRST_NAME contains 'a'

ans: select first_name from worker where first_name like "%a%";

9.  Write an SQL query to print details of the Workers whose FIRST_NAME ends with ‘h’ and contains six alphabets

ans:  select first_name from worker where first_name like "%______h";

10.  Write an SQL query to print details of the Workers whose SALARY lies between 100000 and 500000

ans:  select first_name,salary from worker where salary between 100000  AND 500000;

11.  Write an SQL query to print details of the Workers who have joined in Feb’2014

ans:  select first_name,Joining_date from worker where JOINING_DATE LIKE "2014-02%";

12.  Write an SQL query to fetch the count of employees working in the department ‘Admin’

ans:  select count(first_name) as "no of employees in admin" from worker where department = "Admin";

13.  Write an SQL query to fetch the no. of workers for each department in the descending order

ans:  SELECT COUNT(FIRST_NAME) AS "NO_OF_EMPLOYEES PER DEPARTMENT",DEPARTMENT FROM WORKER GROUP BY DEPARTMENT
      ORDER BY DEPARTMENT DESC;

14.  Write a query to display workerrs who are managers

ans:	SELECT Worker.Worker_id, Worker.first_name from 
    	Worker JOIN Title ON 
    	Worker.Worker_id=Title.Worker_ref_id
    	where Title.Worker_Title ="Manager";

15.  Write query to find duplicate rows title table

16.  Write an SQL query to show all workers who got the bonus
along with bonus amount

ans:	select w.Worker_id,w.first_name ,w.last_name,b.bonus_amount from Worker w 
	join Bonus b on w.Worker_id = b.Worker_ref_id

17.  Write a query to find employees in worker table that do not exist in bonus table (ie did not get bonus)

ans: 	select w.Worker_id,w.first_name from Worker w where w.Worker_id not in
	(select w.Worker_id from worker w join bonus b on w.worker_id = b.worker_ref_id);

18.  Write a query to find the highest 2 salaries

ans: 	select * from worker order by salary desc limit 2;


19.  Find 2nd highest salary without using LIMIT

ans: 	select max(salary) from worker where salary <(select max(salary) from worker);

20.  Find people who have the same salary

ans:
select * from worker where salary IN
(select salary from worker w1 where worker.Worker_id <> w1.Worker_id);

 

21.  Write a query to fetch 1st 50% records without using limit

// COUNT(1) means “count the values in the first column and return the number of rows.”
// COUNT(*) will use the whole table to get to the same result.

WITH ranked_records AS (
SELECT *, ROW_NUMBER() OVER (ORDER BY id) AS row_num
FROM worker
)
SELECT *
FROM ranked_records
WHERE row_num <= (SELECT COUNT(*) / 2 FROM worker);


22.  Write a query to select a department with more than 3 people in worker table

ans:	SELECT department FROM worker GROUP BY department HAVING COUNT(*) > 3;


23.  Write a query to select 1st and last row of a worker table

ans:	(SELECT * FROM worker ORDER BY worker_id ASC LIMIT 1) UNION ALL
	(SELECT * FROM worker ORDER BY worker_id DESC LIMIT 1);


24.  Write a query to select last 5 entries from worker table

ans:  select * from worker order by worker_id desc limit 5;

25.  Write a query to select people with highest salary in each group

ans:  select max(salary),department from worker group by department);

26.  Write a query to fetch departments along with the total salaries paid for each of them

ans:	select department, sum(salary) as "Total salary per department" from worker group by department;
	
27.  Write a query to fetch the names of workers who earn the highest salary

ans:
	select first_name,worker_id from worker
	where salary = (select max(salary) as "Highest Salary" from worker);
